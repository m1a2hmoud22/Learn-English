<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„Ø¹Ø¨Ø© Ù†Ø¬Ù… Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="style.css">
    <!-- <style>
        body {
            font-family: 'Cairo', sans-serif;
            transition: background-color 0.3s, color 0.3s;
        }
        .game-card {
            transition: transform 0.3s, box-shadow 0.3s, opacity 0.3s;
        }
        .game-card:not(.locked):hover {
            transform: translateY(-5px);
        }
        .btn {
            transition: background-color 0.3s, transform 0.2s;
        }
        .btn:hover {
            transform: scale(1.05);
        }
        .correct-answer {
            animation: correct 0.5s ease-in-out;
        }
        @keyframes correct {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        .wrong-answer {
            animation: shake 0.5s;
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }
        /* Locked Level Style */
        .level-card.locked {
            opacity: 0.6;
            cursor: not-allowed;
            background-color: #e5e7eb;
        }
        .dark .level-card.locked {
            background-color: #374151;
        }
        .lock-icon {
            position: absolute;
            top: 10px;
            left: 10px;
            font-size: 1.5rem;
            opacity: 0.7;
        }

        /* Modal Styles */
        .modal-backdrop {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.6); z-index: 40;
            opacity: 0; transition: opacity 0.3s; pointer-events: none;
        }
        .modal-backdrop.active { opacity: 1; pointer-events: all; }
        .modal {
            position: fixed; top: 50%; left: 50%;
            transform: translate(-50%, -50%) scale(0.9); z-index: 50;
            transition: transform 0.3s, opacity 0.3s;
            opacity: 0; pointer-events: none;
        }
        .modal.active { transform: translate(-50%, -50%) scale(1); opacity: 1; pointer-events: all; }

        /* Dark Mode Toggle */
        .toggle-switch { position: relative; display: inline-block; width: 60px; height: 34px; }
        .toggle-switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 34px; }
        .slider:before { position: absolute; content: "â˜€ï¸"; height: 26px; width: 26px; left: 4px; bottom: 4px; background-color: white; transition: .4s; border-radius: 50%; text-align: center; line-height: 26px; }
        input:checked + .slider { background-color: #4a5568; }
        input:checked + .slider:before { transform: translateX(26px); content: "ğŸŒ™"; }
        
        /* Dark mode styles */
        .dark { background-color: #1a202c; color: #e2e8f0; }
        .dark .game-card, .dark .level-card, .dark .modal-content { background-color: #2d3748; border-color: #4a5568; }
        .dark .btn-primary { background-color: #4299e1; color: #1a202c; }
        .dark .btn-primary:hover { background-color: #63b3ed; }
        .dark .text-gray-800 { color: #e2e8f0; }
        .dark .text-gray-700 { color: #a0aec0; }
        .dark .text-gray-600 { color: #a0aec0; }
        .dark .text-gray-500 { color: #cbd5e0; }
        .dark .bg-gray-100 { background-color: #2d3748; }
        .dark .bg-white { background-color: #2d3748; }
        .dark input { background-color: #4a5568; color: #e2e8f0; border-color: #718096; }
        .dark .border-gray-300 { border-color: #4a5568; }
        .dark .bg-blue-100 { background-color: #2c5282; }
    </style> -->
</head>
<body class="bg-gray-100">

    <div id="app-container" class="container mx-auto p-4 min-h-screen flex flex-col items-center justify-center">

        <header class="w-full max-w-3xl mx-auto flex justify-between items-center mb-6">
            <h1 class="text-3xl md:text-4xl font-bold text-blue-500">ğŸŒŸ Ù„Ø¹Ø¨Ø© Ù†Ø¬Ù… Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©</h1>
            <label class="toggle-switch">
                <input type="checkbox" id="darkModeToggle">
                <span class="slider"></span>
            </label>
        </header>

        <div id="level-selection-screen" class="w-full max-w-3xl text-center">
            <h2 class="text-2xl font-bold text-gray-800 mb-6">Ø§Ø®ØªØ± Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØµØ¹ÙˆØ¨Ø©</h2>
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4" id="levels-grid">
                <div id="level-Ø³Ù‡Ù„" data-level="Ø³Ù‡Ù„" class="level-card bg-white p-6 rounded-xl shadow-lg cursor-pointer game-card border-4 border-transparent hover:border-green-400 relative">
                    <div class="lock-icon hidden">ğŸ”’</div>
                    <div class="text-5xl mb-2">ğŸ§¸</div>
                    <h3 class="text-xl font-bold text-green-500">Ø³Ù‡Ù„</h3>
                </div>
                <div id="level-Ù…ØªÙˆØ³Ø·" data-level="Ù…ØªÙˆØ³Ø·" class="level-card bg-white p-6 rounded-xl shadow-lg cursor-pointer game-card border-4 border-transparent hover:border-yellow-400 relative">
                    <div class="lock-icon hidden">ğŸ”’</div>
                    <div class="text-5xl mb-2">ğŸš€</div>
                    <h3 class="text-xl font-bold text-yellow-500">Ù…ØªÙˆØ³Ø·</h3>
                </div>
                <div id="level-ØµØ¹Ø¨" data-level="ØµØ¹Ø¨" class="level-card bg-white p-6 rounded-xl shadow-lg cursor-pointer game-card border-4 border-transparent hover:border-red-400 relative">
                    <div class="lock-icon hidden">ğŸ”’</div>
                    <div class="text-5xl mb-2">ğŸ§ </div>
                    <h3 class="text-xl font-bold text-red-500">ØµØ¹Ø¨</h3>
                </div>
                 <div id="level-ØªØ­Ø¯ÙŠ Ø§Ù„ÙˆÙ‚Øª" data-level="ØªØ­Ø¯ÙŠ Ø§Ù„ÙˆÙ‚Øª" class="level-card bg-white p-6 rounded-xl shadow-lg cursor-pointer game-card border-4 border-transparent hover:border-purple-400 relative">
                    <div class="lock-icon hidden">ğŸ”’</div>
                    <div class="text-5xl mb-2">â±ï¸</div>
                    <h3 class="text-xl font-bold text-purple-500">ØªØ­Ø¯ÙŠ Ø§Ù„ÙˆÙ‚Øª</h3>
                </div>
            </div>
            <button id="rules-btn" class="btn mt-8 bg-gray-500 text-white font-bold py-2 px-6 rounded-lg hover:bg-gray-600">Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ù„Ø¹Ø¨Ø©</button>
        </div>

        <div id="game-screen" class="w-full max-w-2xl mx-auto hidden">
            <div class="game-card bg-white p-6 md:p-8 rounded-2xl shadow-xl">
                <div class="flex justify-between items-center mb-6 border-b border-gray-300 pb-4">
                    <div><span class="text-gray-600">Ø§Ù„Ù…Ø³ØªÙˆÙ‰:</span> <span id="level-display" class="font-bold text-blue-500"></span></div>
                    <div id="timer-container" class="hidden"><span class="text-gray-600">Ø§Ù„ÙˆÙ‚Øª:</span> <span id="timer-display" class="font-bold text-red-500">15</span></div>
                    <div><span class="text-gray-600">Ø§Ù„Ù†Ù‚Ø§Ø·:</span> <span id="score-display" class="font-bold text-green-500">0</span></div>
                </div>
                <div class="text-center">
                    <p id="question-prompt" class="text-lg text-gray-600 mb-2"></p>
                    <h2 id="word-display" class="text-4xl md:text-5xl font-bold text-gray-800 mb-6 h-20 flex items-center justify-center"></h2>
                    <input type="text" id="answer-input" class="w-full p-3 text-center text-xl border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="Ø§ÙƒØªØ¨ Ø¥Ø¬Ø§Ø¨ØªÙƒ Ù‡Ù†Ø§...">
                    <button id="check-btn" class="btn btn-primary w-full mt-4 bg-blue-500 text-white font-bold py-3 rounded-lg text-xl hover:bg-blue-600">ØªØ­Ù‚Ù‚</button>
                </div>
                <div id="message-area" class="mt-4 text-center font-semibold text-lg h-8"></div>
            </div>
        </div>

        <div id="final-score-screen" class="w-full max-w-md mx-auto text-center hidden">
            <div class="game-card bg-white p-8 rounded-2xl shadow-xl">
                <div id="final-emoji" class="text-7xl mb-4">ğŸ‰</div>
                <h2 id="final-title" class="text-3xl font-bold text-gray-800 mb-2">Ø£Ø¯Ø§Ø¡ Ø±Ø§Ø¦Ø¹!</h2>
                <p id="final-message" class="text-gray-600 mb-4">Ù„Ù‚Ø¯ Ø£ÙƒÙ…Ù„Øª Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø¨Ù†Ø¬Ø§Ø­.</p>
                <div class="bg-blue-100 p-4 rounded-lg">
                    <p class="text-lg text-gray-700">Ù†Ù‚Ø§Ø·Ùƒ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© Ù‡ÙŠ:</p>
                    <p id="final-score-display" class="text-5xl font-bold text-blue-500 my-2">0</p>
                </div>
                <button onclick="playAgain()" class="btn w-full mt-6 bg-green-500 text-white font-bold py-3 rounded-lg text-xl hover:bg-green-600">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
            </div>
        </div>
    </div>

    <div id="rules-modal-backdrop" class="modal-backdrop"></div>
    <div id="rules-modal" class="modal w-11/12 max-w-lg">
        <div class="modal-content bg-white p-6 rounded-lg shadow-xl text-gray-800">
            <div class="flex justify-between items-center border-b border-gray-300 pb-3 mb-4">
                <h2 class="text-2xl font-bold text-blue-500">Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ù„Ø¹Ø¨Ø©</h2>
                <button id="close-rules-btn" class="text-3xl font-bold text-gray-500 hover:text-gray-800">&times;</button>
            </div>
            <ul class="list-disc list-inside space-y-3">
                <li>ÙŠØ¬Ø¨ Ø¹Ù„ÙŠÙƒ Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª Ø¨Ø§Ù„ØªØ±ØªÙŠØ¨.</li>
                <li>Ø§ÙØªØ­ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªØ§Ù„ÙŠ Ø¨Ø­ØµÙˆÙ„Ùƒ Ø¹Ù„Ù‰ 80 Ù†Ù‚Ø·Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ ÙÙŠ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø­Ø§Ù„ÙŠ.</li>
                <li>Ù„Ø¯ÙŠÙƒ Ù…Ø­Ø§ÙˆÙ„ØªØ§Ù† Ù„ÙƒÙ„ Ø³Ø¤Ø§Ù„ ÙÙŠ Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª (Ø³Ù‡Ù„ØŒ Ù…ØªÙˆØ³Ø·ØŒ ØµØ¹Ø¨).</li>
                <li>**Ù†Ø¸Ø§Ù… Ø§Ù„Ù†Ù‚Ø§Ø·:**
                    <ul class="list-disc list-inside pr-6 mt-1 space-y-1">
                        <li><span class="font-bold text-green-500">10 Ù†Ù‚Ø§Ø·</span> Ù„Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© Ù…Ù† Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰.</li>
                        <li><span class="font-bold text-yellow-500">5 Ù†Ù‚Ø§Ø·</span> Ù„Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© Ù…Ù† Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©.</li>
                    </ul>
                </li>
                <li>**ØªØ­Ø¯ÙŠ Ø§Ù„ÙˆÙ‚Øª:** Ù„Ø¯ÙŠÙƒ <span class="font-bold text-red-500">15 Ø«Ø§Ù†ÙŠØ©</span> ÙÙ‚Ø· Ù„Ù„Ø¥Ø¬Ø§Ø¨Ø©ØŒ ÙˆØ§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© ØªÙ…Ù†Ø­Ùƒ 10 Ù†Ù‚Ø§Ø·.</li>
            </ul>
        </div>
    </div>

    <!-- <script>
        // --- DOM Elements ---
        const levelSelectionScreen = document.getElementById('level-selection-screen');
        const gameScreen = document.getElementById('game-screen');
        const finalScoreScreen = document.getElementById('final-score-screen');
        const levelDisplay = document.getElementById('level-display');
        const scoreDisplay = document.getElementById('score-display');
        const timerContainer = document.getElementById('timer-container');
        const timerDisplay = document.getElementById('timer-display');
        const questionPrompt = document.getElementById('question-prompt');
        const wordDisplay = document.getElementById('word-display');
        const answerInput = document.getElementById('answer-input');
        const checkBtn = document.getElementById('check-btn');
        const messageArea = document.getElementById('message-area');
        const finalScoreDisplay = document.getElementById('final-score-display');
        const finalEmoji = document.getElementById('final-emoji');
        const finalTitle = document.getElementById('final-title');
        const finalMessage = document.getElementById('final-message');
        const darkModeToggle = document.getElementById('darkModeToggle');
        const rulesBtn = document.getElementById('rules-btn');
        const closeRulesBtn = document.getElementById('close-rules-btn');
        const rulesModal = document.getElementById('rules-modal');
        const rulesModalBackdrop = document.getElementById('rules-modal-backdrop');
        const levelsGrid = document.getElementById('levels-grid');

        // --- Game Data ---
        const words = {
            "Ø³Ù‡Ù„": { "Ù‚Ø·Ø©": "cat", "ÙƒÙ„Ø¨": "dog", "Ø´Ù…Ø³": "sun", "ÙˆÙ„Ø¯": "boy", "Ø¨Ù†Øª": "girl", "ÙƒØªØ§Ø¨": "book", "Ø³ÙŠØ§Ø±Ø©": "car", "ØªÙØ§Ø­Ø©": "apple", "Ù…Ø§Ø¡": "water", "Ø¨ÙŠØª": "house" },
            "Ù…ØªÙˆØ³Ø·": { "Ø³Ø¹ÙŠØ¯": "happy", "Ù…Ø¯Ø±Ø³Ø©": "school", "ØµØ¯ÙŠÙ‚": "friend", "Ø·Ø¹Ø§Ù…": "food", "Ø¹Ø§Ø¦Ù„Ø©": "family", "ÙŠÙ„Ø¹Ø¨": "play", "ÙƒØ¨ÙŠØ±": "big", "ØµØºÙŠØ±": "small", "Ø²Ù‡Ø±Ø©": "flower", "Ø´Ø¬Ø±Ø©": "tree" },
            "ØµØ¹Ø¨": { "ÙƒÙ…Ø¨ÙŠÙˆØªØ±": "computer", "Ù…Ø¹Ù„ÙˆÙ…Ø§Øª": "information", "Ù…Ø³ØªØ´ÙÙ‰": "hospital", "Ù…ØºØ§Ù…Ø±Ø©": "adventure", "Ù…ÙƒØªØ¨Ø©": "library", "Ø¬Ù…ÙŠÙ„": "beautiful", "Ù‚ÙˆØ©": "strength", "Ù…Ø®ØªÙ„Ù": "different", "Ù…Ø¹Ø±ÙØ©": "knowledge", "Ø­ÙƒÙˆÙ…Ø©": "government" },
            "ØªØ­Ø¯ÙŠ Ø§Ù„ÙˆÙ‚Øª": { "ÙƒÙ…Ø¨ÙŠÙˆØªØ±": "computer", "Ù…Ø¹Ù„ÙˆÙ…Ø§Øª": "information", "Ù…Ø³ØªØ´ÙÙ‰": "hospital", "Ù…ØºØ§Ù…Ø±Ø©": "adventure", "Ù…ÙƒØªØ¨Ø©": "library", "Ø¬Ù…ÙŠÙ„": "beautiful", "Ù‚ÙˆØ©": "strength", "Ù…Ø®ØªÙ„Ù": "different", "Ù…Ø¹Ø±ÙØ©": "knowledge", "Ø­ÙƒÙˆÙ…Ø©": "government" }
        };
        const levelOrder = ["Ø³Ù‡Ù„", "Ù…ØªÙˆØ³Ø·", "ØµØ¹Ø¨", "ØªØ­Ø¯ÙŠ Ø§Ù„ÙˆÙ‚Øª"];
        const levelThreshold = 80;
        const positiveFeedback = ["Ø±Ø§Ø¦Ø¹! âœ¨", "Ø£Ø­Ø³Ù†Øª! ğŸ‰", "Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©! ğŸ‘", "Ø£Ù†Øª Ù†Ø¬Ù…! ğŸŒŸ", "Ù…Ø°Ù‡Ù„! ğŸ¤©"];
        const encouragingFeedback = ["Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ØŒ Ø£Ù†Øª ØªØ³ØªØ·ÙŠØ¹! ğŸ’ª", "Ù„Ø§ Ø¨Ø£Ø³ØŒ ÙÙƒØ± Ù…Ø±Ø© Ø£Ø®Ø±Ù‰! ğŸ¤”", "Ù‚Ø±ÙŠØ¨ Ø¬Ø¯Ù‹Ø§ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø¬Ø¯Ø¯Ù‹Ø§! ğŸ¯"];

        // --- Game State ---
        let currentLevel = '';
        let score = 0;
        let currentQuestions = [];
        let questionIndex = 0;
        let attempts = 0;
        let currentCorrectAnswer = '';
        let timerInterval;
        let timeLeft = 15;

        // --- Event Listeners ---
        checkBtn.addEventListener('click', checkAnswer);
        answerInput.addEventListener('keyup', (event) => { if (event.key === 'Enter') checkBtn.click(); });
        darkModeToggle.addEventListener('change', () => document.body.classList.toggle('dark'));
        rulesBtn.addEventListener('click', () => {
            rulesModal.classList.add('active');
            rulesModalBackdrop.classList.add('active');
        });
        closeRulesBtn.addEventListener('click', closeRulesModal);
        rulesModalBackdrop.addEventListener('click', closeRulesModal);

        function closeRulesModal() {
            rulesModal.classList.remove('active');
            rulesModalBackdrop.classList.remove('active');
        }

        // --- Game Initialization ---
        function init() {
            updateLevelsUI();
            levelsGrid.addEventListener('click', (e) => {
                const levelCard = e.target.closest('.level-card');
                if (levelCard && !levelCard.classList.contains('locked')) {
                    startGame(levelCard.dataset.level);
                }
            });
        }
        
        function updateLevelsUI() {
            const unlockedLevelIndex = levelOrder.indexOf(localStorage.getItem('unlockedLevel') || 'Ø³Ù‡Ù„');
            document.querySelectorAll('.level-card').forEach((card, index) => {
                const lockIcon = card.querySelector('.lock-icon');
                if (index > unlockedLevelIndex) {
                    card.classList.add('locked');
                    lockIcon.classList.remove('hidden');
                } else {
                    card.classList.remove('locked');
                    lockIcon.classList.add('hidden');
                }
            });
        }

        // --- Game Functions ---
        function startGame(level) {
            currentLevel = level;
            score = 0;
            questionIndex = 0;
            levelDisplay.textContent = level;
            scoreDisplay.textContent = score;
            
            timerContainer.classList.toggle('hidden', level !== 'ØªØ­Ø¯ÙŠ Ø§Ù„ÙˆÙ‚Øª');

            const levelWords = words[level];
            currentQuestions = Object.entries(levelWords);
            shuffleArray(currentQuestions);

            levelSelectionScreen.classList.add('hidden');
            gameScreen.classList.remove('hidden');
            finalScoreScreen.classList.add('hidden');

            nextQuestion();
        }

        function nextQuestion() {
            if (questionIndex >= currentQuestions.length) {
                endGame();
                return;
            }
            clearInterval(timerInterval);
            attempts = 0;
            answerInput.value = '';
            answerInput.disabled = false;
            answerInput.focus();
            messageArea.textContent = '';
            wordDisplay.classList.remove('correct-answer', 'wrong-answer');
            checkBtn.disabled = false;

            const [arabicWord, englishWord] = currentQuestions[questionIndex];

            if (Math.random() < 0.5) {
                questionPrompt.textContent = `Ù…Ø§ Ù‡ÙŠ ØªØ±Ø¬Ù…Ø© ÙƒÙ„Ù…Ø© '${arabicWord}' Ø¨Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©ØŸ`;
                wordDisplay.textContent = arabicWord;
                currentCorrectAnswer = englishWord;
            } else {
                questionPrompt.textContent = `Ù…Ø§ Ù‡ÙŠ ØªØ±Ø¬Ù…Ø© ÙƒÙ„Ù…Ø© '${englishWord}' Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©ØŸ`;
                wordDisplay.textContent = englishWord;
                currentCorrectAnswer = arabicWord;
            }

            if (currentLevel === 'ØªØ­Ø¯ÙŠ Ø§Ù„ÙˆÙ‚Øª') startTimer();
        }

        function startTimer() {
            timeLeft = 15;
            timerDisplay.textContent = timeLeft;
            timerInterval = setInterval(() => {
                timeLeft--;
                timerDisplay.textContent = timeLeft;
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    handleTimeUp();
                }
            }, 1000);
        }
        
        function handleTimeUp() {
            messageArea.innerHTML = `Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª! Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ù‡ÙŠ: <span class="font-bold text-red-500">${currentCorrectAnswer}</span>`;
            messageArea.style.color = '#EF4444';
            answerInput.disabled = true;
            checkBtn.disabled = true;
            questionIndex++;
            setTimeout(nextQuestion, 3000);
        }

        function checkAnswer() {
            const userAnswer = answerInput.value.trim().toLowerCase();
            if (!userAnswer) return;
            clearInterval(timerInterval);
            if (userAnswer === currentCorrectAnswer.toLowerCase()) handleCorrectAnswer();
            else handleWrongAnswer();
        }

        function handleCorrectAnswer() {
            score += (currentLevel === 'ØªØ­Ø¯ÙŠ Ø§Ù„ÙˆÙ‚Øª' || attempts === 0) ? 10 : 5;
            scoreDisplay.textContent = score;
            messageArea.textContent = randomChoice(positiveFeedback);
            messageArea.style.color = '#10B981';
            wordDisplay.classList.add('correct-answer');
            answerInput.disabled = true;
            checkBtn.disabled = true;
            questionIndex++;
            setTimeout(nextQuestion, 1500);
        }
        
        function handleWrongAnswer() {
            attempts++;
            wordDisplay.classList.add('wrong-answer');
            setTimeout(() => wordDisplay.classList.remove('wrong-answer'), 500);

            if (currentLevel === 'ØªØ­Ø¯ÙŠ Ø§Ù„ÙˆÙ‚Øª' || attempts >= 2) {
                messageArea.innerHTML = `Ù„Ù„Ø£Ø³Ù! Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© Ù‡ÙŠ: <span class="font-bold text-red-500">${currentCorrectAnswer}</span>`;
                messageArea.style.color = '#EF4444';
                answerInput.disabled = true;
                checkBtn.disabled = true;
                questionIndex++;
                setTimeout(nextQuestion, 3000);
            } else {
                messageArea.textContent = randomChoice(encouragingFeedback);
                messageArea.style.color = '#F59E0B';
                answerInput.value = '';
                answerInput.focus();
            }
        }

        function endGame() {
            const currentLevelIndex = levelOrder.indexOf(currentLevel);
            const unlockedLevelIndex = levelOrder.indexOf(localStorage.getItem('unlockedLevel') || 'Ø³Ù‡Ù„');
            
            // Check for unlocking the next level
            if (score >= levelThreshold && currentLevelIndex < levelOrder.length - 1 && currentLevelIndex >= unlockedLevelIndex) {
                 const nextLevel = levelOrder[currentLevelIndex + 1];
                 localStorage.setItem('unlockedLevel', nextLevel);
                 finalEmoji.textContent = 'ğŸ†';
                 finalTitle.textContent = 'ØªÙ‡Ø§Ù†ÙŠÙ†Ø§!';
                 finalMessage.textContent = `Ù„Ù‚Ø¯ ÙØªØ­Øª Ù‚ÙÙ„ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªØ§Ù„ÙŠ: ${nextLevel}!`;
            } else {
                 finalEmoji.textContent = 'ğŸ‰';
                 finalTitle.textContent = 'Ø£Ø¯Ø§Ø¡ Ø±Ø§Ø¦Ø¹!';
                 finalMessage.textContent = 'Ù„Ù‚Ø¯ Ø£ÙƒÙ…Ù„Øª Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø¨Ù†Ø¬Ø§Ø­.';
            }

            gameScreen.classList.add('hidden');
            finalScoreScreen.classList.remove('hidden');
            finalScoreDisplay.textContent = score;
        }

        function playAgain() {
            finalScoreScreen.classList.add('hidden');
            levelSelectionScreen.classList.remove('hidden');
            updateLevelsUI();
        }

        // --- Helper Functions ---
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }
        function randomChoice(array) {
            return array[Math.floor(Math.random() * array.length)];
        }
        
        // --- Start the app ---
        init();
    </script> -->
    <script src="main.js"></script>
</body>
</html>
